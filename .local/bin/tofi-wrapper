#!/bin/bash

app=$(grep -h "^Name=" /usr/share/applications/*.desktop ~/.local/share/applications/*.desktop 2>/dev/null | \
    cut -d= -f2 | \
    sort -u | \
    tofi --prompt-text "run: " --require-match=false)

[ -z "$app" ] && exit 0

desktop=$(grep -l "^Name=$app$" /usr/share/applications/*.desktop ~/.local/share/applications/*.desktop 2>/dev/null | head -1)

if [ -n "$desktop" ]; then
    swaymsg exec "gtk-launch $(basename "$desktop")"
else
    swaymsg exec "$app"
fi
