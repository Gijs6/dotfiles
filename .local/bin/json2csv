#!/usr/bin/env python
import argparse
import json
import csv
import os
import sys

def json_file_to_csv(input_file, output_file):
    with open(input_file, "r", encoding="utf-8") as f:
        data = json.load(f)

    if not data:
        print("No data found.", file=sys.stderr)
        return

    headers = data[0].keys()

    with open(output_file, "w", newline="", encoding="utf-8") as f:
        writer = csv.DictWriter(f, fieldnames=headers)
        writer.writeheader()
        writer.writerows(data)

    print(f"Saved {len(data)} rows to {os.path.abspath(output_file)}")

def main():
    parser = argparse.ArgumentParser(
        description="Convert a JSON file (list of dicts) to CSV"
    )
    parser.add_argument("-i", "--input", required=True, help="Path to input JSON file")
    parser.add_argument("-o", "--output", required=True, help="Path to output CSV file")
    args = parser.parse_args()

    json_file_to_csv(args.input, args.output)

if __name__ == "__main__":
    main()
